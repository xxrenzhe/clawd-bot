---
interface Props {
  context?: 'setup' | 'inline' | 'conclusion';
}

const { context = 'inline' } = Astro.props;

const referralUrl = import.meta.env.HOSTING_REFERRAL_URL || 'https://hosting.com';
const trackingId = import.meta.env.HOSTING_REFERRAL_TRACKING_ID || 'clawdbot';

// Add UTM parameters for tracking
const url = new URL(referralUrl);
url.searchParams.set('utm_source', 'clawd-bot.app');
url.searchParams.set('utm_medium', 'referral');
url.searchParams.set('utm_campaign', trackingId);
url.searchParams.set('utm_content', context);

const messages = {
  setup: {
    title: 'Need Reliable Hosting for Openclaw?',
    description: 'Run Openclaw (Moltbot/Clawdbot) 24/7 on a powerful VPS. Get started with high-performance hosting optimized for AI workloads.',
    cta: 'Get Started with Hosting.com',
  },
  inline: {
    title: 'Deploy Openclaw on Professional Infrastructure',
    description: 'Keep Openclaw (Moltbot/Clawdbot) running around the clock with enterprise-grade VPS hosting.',
    cta: 'Explore Hosting Options',
  },
  conclusion: {
    title: 'Ready to Deploy Openclaw?',
    description: 'Take the next step and host your AI assistant on reliable, high-performance infrastructure. Perfect for running Openclaw 24/7.',
    cta: 'Start Your VPS Today',
  },
};

const message = messages[context];
---

<div class="hosting-cta not-prose my-8 rounded-lg border-2 border-blue-200/80 bg-gradient-to-br from-blue-50 to-indigo-50 p-6 shadow-md dark:border-blue-800 dark:from-blue-950 dark:to-indigo-950">
  <div class="flex flex-col gap-4">
    <div class="flex items-start gap-3">
      <div class="flex-shrink-0 rounded-full bg-blue-500 p-2">
        <svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7"></path>
        </svg>
      </div>
      <div class="flex-1">
        <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">
          {message.title}
        </h3>
        <p class="mt-2 text-gray-700 dark:text-gray-300">
          {message.description}
        </p>
      </div>
    </div>
    <div class="flex items-center justify-between">
      <a
        href={url.toString()}
        target="_blank"
        rel="noopener sponsored"
        class="inline-flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-3 font-semibold text-white transition-all hover:bg-blue-700 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
        data-analytics-event="hosting-cta-click"
        data-analytics-context={context}
      >
        {message.cta}
        <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
        </svg>
      </a>
      <span class="text-sm text-gray-600 dark:text-gray-300">
        Affiliate Link
      </span>
    </div>
  </div>
</div>

<style>
  .hosting-cta {
    animation: fadeIn 0.5s ease-in;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
