---
import BaseLayout from './BaseLayout.astro';
import ArticleSchema from '../components/SEO/ArticleSchema.astro';
import BreadcrumbSchema from '../components/SEO/BreadcrumbSchema.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  entry: CollectionEntry<'articles'>;
}

const { entry } = Astro.props;
const { title, description, keywords, image, pubDate, author, category, readingTime } = entry.data;

const breadcrumbs = [
  { name: 'Home', url: '/' },
  { name: 'Articles', url: '/articles' },
  { name: title, url: Astro.url.pathname },
];
---

<BaseLayout
  title={title}
  description={description}
  keywords={keywords}
  image={image}
  article={true}
  publishedTime={pubDate}
  author={author}
>
  <ArticleSchema
    title={title}
    description={description}
    image={image}
    publishedTime={pubDate}
    author={author}
    keywords={keywords}
  />
  <BreadcrumbSchema items={breadcrumbs} />

  <article class="mx-auto max-w-4xl px-4 py-12 sm:px-6 lg:px-8">
    <!-- Article Header -->
    <header class="mb-8">
      <div class="mb-4 flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400">
        <span class="rounded-full bg-blue-100 px-3 py-1 font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-200">
          {category}
        </span>
        <time datetime={pubDate.toISOString()}>
          {pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
        </time>
        <span>{readingTime} min read</span>
      </div>

      <h1 class="mb-4 text-4xl font-bold leading-tight text-gray-900 dark:text-white md:text-5xl">
        {title}
      </h1>

      <p class="text-xl text-gray-600 dark:text-gray-400">
        {description}
      </p>

      <div class="mt-6 flex items-center gap-3">
        <div class="flex h-10 w-10 items-center justify-center rounded-full bg-blue-600 text-white">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
        </div>
        <div>
          <div class="font-medium text-gray-900 dark:text-white">{author}</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">Author</div>
        </div>
      </div>
    </header>

    <!-- Article Content -->
    <div class="prose prose-lg prose-blue max-w-none dark:prose-invert prose-headings:font-bold prose-a:text-blue-600 hover:prose-a:text-blue-700 prose-code:rounded prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:text-sm prose-code:before:content-[''] prose-code:after:content-[''] dark:prose-code:bg-gray-800">
      <slot />
    </div>

    <!-- Article Footer -->
    <footer class="mt-12 border-t border-gray-200 pt-8 dark:border-gray-800">
      <div class="flex flex-wrap gap-2">
        {keywords?.map((keyword) => (
          <span class="rounded-full bg-gray-100 px-3 py-1 text-sm text-gray-700 dark:bg-gray-800 dark:text-gray-300">
            #{keyword}
          </span>
        ))}
      </div>
    </footer>
  </article>
</BaseLayout>

<style is:global>
  /* Custom prose styles for better readability */
  .prose img {
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  }

  .prose pre {
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  }
</style>
